# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ BTC Lottery

## –û–±–∑–æ—Ä —Ñ–∞–π–ª–æ–≤

```
Lottery BTC/
‚îÇ
‚îú‚îÄ‚îÄ üìÑ –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ lottery_core.py      # –Ø–¥—Ä–æ –ª–æ–≥–∏–∫–∏ –ª–æ—Ç–µ—Ä–µ–∏ (SHA256, score, –≤—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è)
‚îÇ   ‚îú‚îÄ‚îÄ bitcoin_api.py       # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Bitcoin API (–ø–æ–ª—É—á–µ–Ω–∏–µ —Ö–µ—à–µ–π –±–ª–æ–∫–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ app.py               # Flask –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ REST API
‚îÇ   ‚îî‚îÄ‚îÄ demo.py              # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏
‚îÇ
‚îú‚îÄ‚îÄ üåê Frontend
‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.html       # –ì–ª–∞–≤–Ω–∞—è HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îî‚îÄ‚îÄ static/
‚îÇ       ‚îú‚îÄ‚îÄ css/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ style.css    # –°—Ç–∏–ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îÇ       ‚îî‚îÄ‚îÄ js/
‚îÇ           ‚îî‚îÄ‚îÄ app.js       # JavaScript –ª–æ–≥–∏–∫–∞ frontend
‚îÇ
‚îú‚îÄ‚îÄ üìã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ tickets.json         # –°–ø–∏—Å–æ–∫ –±–∏–ª–µ—Ç–æ–≤ –¥–ª—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt     # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ .gitignore          # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã Git
‚îÇ
‚îî‚îÄ‚îÄ üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ README.md            # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ QUICKSTART.md        # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
    ‚îú‚îÄ‚îÄ API_EXAMPLES.md      # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
    ‚îî‚îÄ‚îÄ PROJECT_STRUCTURE.md # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π

### `lottery_core.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –Ø–¥—Ä–æ –ª–æ–≥–∏–∫–∏ –ª–æ—Ç–µ—Ä–µ–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
- `generate_seed(block_hashes)` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è seed –∏–∑ —Ö–µ—à–µ–π –±–ª–æ–∫–æ–≤
- `compute_score(seed_bytes, ticket_number)` - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ score –¥–ª—è –±–∏–ª–µ—Ç–∞
- `pick_winner(seed_hex, tickets)` - –í—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
- `get_lottery_result(block_hashes, tickets)` - –ü–æ–ª–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–æ–∑—ã–≥—Ä—ã—à–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: `hashlib`, `json`

---

### `bitcoin_api.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Bitcoin –±–ª–æ–∫—á–µ–π–Ω–∞

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
- `get_block_hash_by_height(height)` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ö–µ—à–∞ –±–ª–æ–∫–∞ –ø–æ –≤—ã—Å–æ—Ç–µ
- `get_latest_block_hash()` - –•–µ—à –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–ª–æ–∫–∞
- `get_latest_block_height()` - –í—ã—Å–æ—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–ª–æ–∫–∞
- `get_block_hashes_for_draw(draw_block_height, count)` - –•–µ—à–∏ –¥–ª—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: `requests`

**API**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π API Blockstream (`blockstream.info`)

---

### `app.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –í–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ REST API

**–ú–∞—Ä—à—Ä—É—Ç—ã**:
- `GET /` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- `POST /api/lottery/draw` - –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–æ–∑—ã–≥—Ä—ã—à
- `GET /api/lottery/tickets` - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –±–∏–ª–µ—Ç–æ–≤
- `POST /api/lottery/verify` - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- `GET /api/bitcoin/latest` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Å–ª–µ–¥–Ω–µ–º –±–ª–æ–∫–µ

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: `Flask`, `flask-cors`

---

### `demo.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –≤ –∫–æ–Ω—Å–æ–ª–∏

**–§—É–Ω–∫—Ü–∏–∏**:
- `demo_with_real_blocks()` - –î–µ–º–æ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –±–ª–æ–∫–∞–º–∏ Bitcoin
- `demo_with_custom_data()` - –î–µ–º–æ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: `python3 demo.py`

---

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí Frontend (index.html + app.js)
   ‚Üì
2. Frontend ‚Üí Flask API (app.py)
   ‚Üì
3. Flask API ‚Üí Bitcoin API (bitcoin_api.py)
   ‚Üì
4. Bitcoin API ‚Üí Blockstream API (–≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å)
   ‚Üì
5. Bitcoin API ‚Üí Flask API (—Ö–µ—à–∏ –±–ª–æ–∫–æ–≤)
   ‚Üì
6. Flask API ‚Üí Lottery Core (lottery_core.py)
   ‚Üì
7. Lottery Core ‚Üí –í—ã—á–∏—Å–ª–µ–Ω–∏–µ seed –∏ score
   ‚Üì
8. Lottery Core ‚Üí –í—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
   ‚Üì
9. Flask API ‚Üí Frontend (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
   ‚Üì
10. Frontend ‚Üí –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

---

## –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

### –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤
```python
block_hashes = get_block_hashes_for_draw(count=3)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: ['hash1', 'hash2', 'hash3']
```

### –®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è seed
```python
seed_bytes = generate_seed(block_hashes)
seed_hex = seed_bytes.hex()
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 'a1b2c3d4e5f6...'
```

### –®–∞–≥ 3: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∏–ª–µ—Ç–∞
```python
for ticket in tickets:
    score = compute_score(seed_bytes, ticket)
    # score = SHA256(seed + ":" + ticket_number)
```

### –®–∞–≥ 4: –í—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
```python
winner = ticket_with_minimum_score
```

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### Python –ø–∞–∫–µ—Ç—ã (requirements.txt)
- `Flask==3.0.0` - –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- `flask-cors==4.0.0` - CORS –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- `requests==2.31.0` - HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ Bitcoin API

### –í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã
- Blockstream API (`blockstream.info`) - –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö Bitcoin –±–ª–æ–∫—á–µ–π–Ω–∞

---

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

1. –û—Ç–∫—Ä–æ–π—Ç–µ `app.py`
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π –º–∞—Ä—à—Ä—É—Ç:
```python
@app.route('/api/new-endpoint', methods=['GET'])
def new_endpoint():
    return jsonify({'success': True})
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤—ã–±–æ—Ä–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ `lottery_core.py`
2. –ò–∑–º–µ–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `pick_winner()` –∏–ª–∏ `compute_score()`

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ `bitcoin_api.py`
2. –ò–∑–º–µ–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –±–ª–æ–∫–æ–≤ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç —è–¥—Ä–∞ –ª–æ–≥–∏–∫–∏
```bash
python3 -c "from lottery_core import pick_winner; print('OK')"
```

### –¢–µ—Å—Ç Bitcoin API
```bash
python3 bitcoin_api.py
```

### –¢–µ—Å—Ç –¥–µ–º–æ
```bash
python3 demo.py
```

### –¢–µ—Å—Ç –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
```bash
python3 app.py
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5000
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
2. **Rate limiting**: –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
3. **HTTPS**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSL/TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
4. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –î–æ–±–∞–≤—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í–µ–¥–∏—Ç–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
6. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ö—ç—à–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Bitcoin API
2. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–ª–æ–∫–æ–≤
3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ë–î –≤–º–µ—Å—Ç–æ JSON —Ñ–∞–π–ª–æ–≤

---

–ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ! üöÄ


