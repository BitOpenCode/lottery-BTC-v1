# üé∞ BTC Lottery - –ß–µ—Å—Ç–Ω–∞—è –ª–æ—Ç–µ—Ä–µ—è –Ω–∞ –æ—Å–Ω–æ–≤–µ Bitcoin –±–ª–æ–∫–æ–≤

–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ—Ç–µ—Ä–µ–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è —Ö–µ—à–∏ –±–ª–æ–∫–æ–≤ Bitcoin –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏.

> üìò **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤**: –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–º. –≤ [DEVELOPER_GUIDE.md](DEVELOPER_GUIDE.md)

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –ª–æ—Ç–µ—Ä–µ–∏ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã–º —Å–ø–æ—Å–æ–±–æ–º:
1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ö–µ—à–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –±–ª–æ–∫–æ–≤ Bitcoin –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏
2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç seed –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–ª–æ–∫–æ–≤ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. –í—ã—á–∏—Å–ª—è–µ—Ç score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∏–ª–µ—Ç–∞: `SHA256(seed + ":" + ticket_number)`
4. –ü–æ–±–µ–¥–∏—Ç–µ–ª—å - –±–∏–ª–µ—Ç —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º score

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
python app.py
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:5000`

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Lottery BTC/
‚îú‚îÄ‚îÄ app.py                 # Flask API —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ lottery_core.py        # –Ø–¥—Ä–æ –ª–æ–≥–∏–∫–∏ –ª–æ—Ç–µ—Ä–µ–∏
‚îú‚îÄ‚îÄ bitcoin_api.py         # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Bitcoin API
‚îú‚îÄ‚îÄ tickets.json           # –°–ø–∏—Å–æ–∫ –±–∏–ª–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ requirements.txt       # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ index.html         # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îî‚îÄ‚îÄ static/
    ‚îú‚îÄ‚îÄ css/
    ‚îÇ   ‚îî‚îÄ‚îÄ style.css      # –°—Ç–∏–ª–∏
    ‚îî‚îÄ‚îÄ js/
        ‚îî‚îÄ‚îÄ app.js         # Frontend –ª–æ–≥–∏–∫–∞
```

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:5000`
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üé≤ –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–æ–∑—ã–≥—Ä—ã—à"
3. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –±–ª–æ–∫–∏ Bitcoin –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
4. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –≤–∫–ª—é—á–∞—è –≤—Å–µ score –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ß–µ—Ä–µ–∑ Python API

```python
from lottery_core import get_lottery_result
from bitcoin_api import get_block_hashes_for_draw

# –ü–æ–ª—É—á–∞–µ–º —Ö–µ—à–∏ –±–ª–æ–∫–æ–≤
block_hashes = get_block_hashes_for_draw(count=3)

# –°–ø–∏—Å–æ–∫ –±–∏–ª–µ—Ç–æ–≤
tickets = [666, 77, 123, 1, 6, 1234]

# –ü—Ä–æ–≤–æ–¥–∏–º —Ä–æ–∑—ã–≥—Ä—ã—à
result = get_lottery_result(block_hashes, tickets)

print(f"–ü–æ–±–µ–¥–∏—Ç–µ–ª—å: –±–∏–ª–µ—Ç ‚Ññ{result['winner']}")
print(f"Seed: {result['seed_hex']}")
```

### –ß–µ—Ä–µ–∑ REST API

#### –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–æ–∑—ã–≥—Ä—ã—à

```bash
curl -X POST http://localhost:5000/api/lottery/draw \
  -H "Content-Type: application/json" \
  -d '{"block_count": 3}'
```

#### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –±–∏–ª–µ—Ç–æ–≤

```bash
curl http://localhost:5000/api/lottery/tickets
```

#### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```bash
curl -X POST http://localhost:5000/api/lottery/verify \
  -H "Content-Type: application/json" \
  -d '{
    "seed_hex": "...",
    "tickets": [666, 77, 123],
    "claimed_winner": "123"
  }'
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Å—Ç–Ω–æ—Å—Ç–∏

–õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

1. –ü–æ–ª—É—á–∏—Ç—å seed (–ø—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω)
2. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –±–∏–ª–µ—Ç–æ–≤
3. –í—ã—á–∏—Å–ª–∏—Ç—å score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∏–ª–µ—Ç–∞: `SHA256(seed + ":" + ticket_number)`
4. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—å –∏–º–µ–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π score

### –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ Python

```python
from lottery_core import pick_winner

seed_hex = "–≤–∞—à_seed_hex"
tickets = [666, 77, 123, 1, 6, 1234]

winner, scores, proof = pick_winner(seed_hex, tickets)

print(f"–ü–æ–±–µ–¥–∏—Ç–µ–ª—å: {winner}")
print(f"–í—Å–µ score: {scores}")
```

## üìä –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è seed

```
seed = SHA256(H_draw || H_draw-1 || H_draw-2)
```

–ì–¥–µ `H_draw`, `H_draw-1`, `H_draw-2` - —Ö–µ—à–∏ –±–ª–æ–∫–æ–≤ Bitcoin.

### 2. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ score

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∏–ª–µ—Ç–∞:
```
score = int(SHA256(seed || ":" || ticket_number))
```

### 3. –í—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è

–ü–æ–±–µ–¥–∏—Ç–µ–ª—å - –±–∏–ª–µ—Ç —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º `score`.

–ü—Ä–∏ –∫–æ–ª–ª–∏–∑–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è tie-breaker:
```
tie_breaker = int(SHA256(seed || ":" || ticket_number || ":tb1"))
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å**: —Ö–µ—à–∏ –±–ª–æ–∫–æ–≤ Bitcoin –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ
- **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å**: –±–ª–æ–∫–∏ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã
- **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—É–±–ª–∏—á–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã
- **–î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å**: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –¥–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∏–ª–µ—Ç–æ–≤

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `tickets.json`:

```json
{
    "tickets": [666, 77, 123, 1, 6, 1234, 34567]
}
```

–ò–ª–∏ –ø–µ—Ä–µ–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –±–∏–ª–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ API –ø—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ —Ä–æ–∑—ã–≥—Ä—ã—à–∞.

## üåê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Bitcoin

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π API Blockstream –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ö–µ—à–µ–π –±–ª–æ–∫–æ–≤:
- `https://blockstream.info/api/block-height/{height}` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ö–µ—à–∞ –±–ª–æ–∫–∞ –ø–æ –≤—ã—Å–æ—Ç–µ
- `https://blockstream.info/api/blocks/tip/height` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–ª–æ–∫–∞

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è "–∫–∞–∫ –µ—Å—Ç—å" –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π.

## ü§ù –í–∫–ª–∞–¥

–õ—é–±—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!

---

**–í–∞–∂–Ω–æ**: –≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∞—É–¥–∏—Ç –∫–æ–¥–∞.

