<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BTC Lottery - –ß–µ—Å—Ç–Ω–∞—è –ª–æ—Ç–µ—Ä–µ—è –Ω–∞ –æ—Å–Ω–æ–≤–µ Bitcoin</title>
    <link rel="stylesheet" href="static/css/style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé∞ BTC Lottery</h1>
            <p class="subtitle">–ß–µ—Å—Ç–Ω–∞—è –ª–æ—Ç–µ—Ä–µ—è –Ω–∞ –æ—Å–Ω–æ–≤–µ Bitcoin –±–ª–æ–∫–æ–≤</p>
        </header>

        <div class="info-section">
            <h2>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?</h2>
            <div class="explanation">
                <p>–ü–æ–±–µ–¥–∏—Ç–µ–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö–µ—à–µ–π –±–ª–æ–∫–æ–≤ Bitcoin. 
                –ö–∞–∂–¥—ã–π –±–∏–ª–µ—Ç –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ (score), –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∏–∑ seed –∏ –Ω–æ–º–µ—Ä–∞ –±–∏–ª–µ—Ç–∞. 
                –ü–æ–±–µ–∂–¥–∞–µ—Ç –±–∏–ª–µ—Ç —Å <strong>–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º score</strong>.</p>
                <p>–ü—Ä–æ—Ü–µ—Å—Å –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–∑—Ä–∞—á–µ–Ω –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º - –ª—é–±–æ–π –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Ä–∞—Å—á—ë—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.</p>
            </div>
        </div>

        <div class="tickets-input-section">
            <h2>üé´ –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä–∞ –±–∏–ª–µ—Ç–æ–≤</h2>
            <div class="tickets-input-container">
                <div class="input-methods">
                    <div class="method-tabs">
                        <button class="tab-btn active" data-method="single">–ü–æ –æ–¥–Ω–æ–º—É</button>
                        <button class="tab-btn" data-method="bulk">–ú–∞—Å—Å–æ–≤—ã–π –≤–≤–æ–¥</button>
                    </div>
                    
                    <div id="singleInputMethod" class="input-method active">
                        <div class="form-group">
                            <input type="number" id="singleTicketInput" placeholder="–ù–æ–º–µ—Ä –±–∏–ª–µ—Ç–∞" class="form-input">
                            <button id="addSingleTicketBtn" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                        </div>
                        <div id="singleTicketsList" class="added-tickets-list"></div>
                    </div>
                    
                    <div id="bulkInputMethod" class="input-method">
                        <textarea id="bulkTicketsInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä–∞ –±–∏–ª–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –∏–ª–∏ –∫–∞–∂–¥—ã–π —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏&#10;–ù–∞–ø—Ä–∏–º–µ—Ä: 666, 77, 123, 1, 6, 1234" class="bulk-input"></textarea>
                        <button id="parseBulkTicketsBtn" class="btn btn-info">üìã –†–∞–∑–æ–±—Ä–∞—Ç—å –Ω–æ–º–µ—Ä–∞</button>
                        <div id="bulkTicketsList" class="added-tickets-list"></div>
                    </div>
                </div>
                
                <div class="current-tickets-summary">
                    <h3>–¢–µ–∫—É—â–∏–µ –±–∏–ª–µ—Ç—ã (<span id="currentTicketsCount">0</span>)</h3>
                    <div id="currentTicketsDisplay" class="current-tickets-display"></div>
                    <button id="clearAllCurrentBtn" class="btn btn-danger btn-small">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>
                </div>
            </div>
        </div>

        <div class="controls">
            <button id="drawBtn" class="btn btn-primary" disabled>üé≤ –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–æ–∑—ã–≥—Ä—ã—à</button>
        </div>

        <div id="ticketsManagement" class="tickets-management hidden" style="display: none;">
            <h2>üé´ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–ª–µ—Ç–∞–º–∏</h2>
            
            <div class="ticket-form">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –±–∏–ª–µ—Ç</h3>
                <div class="form-group">
                    <input type="number" id="newTicketNumber" placeholder="–ù–æ–º–µ—Ä –±–∏–ª–µ—Ç–∞" class="form-input">
                    <button id="addTicketBtn" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </div>

            <div class="tickets-list-management">
                <h3>–°–ø–∏—Å–æ–∫ –±–∏–ª–µ—Ç–æ–≤ (<span id="ticketsCount">0</span>)</h3>
                <div id="ticketsListManagement" class="tickets-list-editable"></div>
                <div class="tickets-actions">
                    <button id="clearAllTicketsBtn" class="btn btn-danger">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>
                    <button id="importTicketsBtn" class="btn btn-info">üì• –ò–º–ø–æ—Ä—Ç –∏–∑ —Ç–µ–∫—Å—Ç–∞</button>
                    <button id="exportTicketsBtn" class="btn btn-info">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
                </div>
            </div>

            <div id="importModal" class="modal hidden">
                <div class="modal-content">
                    <span class="close-modal">&times;</span>
                    <h3>–ò–º–ø–æ—Ä—Ç –±–∏–ª–µ—Ç–æ–≤</h3>
                    <p>–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä–∞ –±–∏–ª–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –∏–ª–∏ –∫–∞–∂–¥—ã–π —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏:</p>
                    <textarea id="importTextarea" rows="10" placeholder="666, 77, 123, 1, 6, 1234"></textarea>
                    <div class="modal-actions">
                        <button id="importConfirmBtn" class="btn btn-primary">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button id="importCancelBtn" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="loading" class="loading hidden">
            <div class="spinner"></div>
            <p>–ü–æ–ª—É—á–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ Bitcoin...</p>
        </div>

        <div id="results" class="results hidden">
            <div class="result-section">
                <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–æ–∑—ã–≥—Ä—ã—à–∞</h2>
                
                <div class="block-info">
                    <h3>–ë–ª–æ–∫–∏ Bitcoin</h3>
                    <p style="font-size: 13px; color: var(--tg-theme-hint-color); margin-bottom: 12px;">
                        –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞ Bitcoin. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Å—ã–ª–∫–∏ –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –±–ª–æ–∫–∏ –≤ –±–ª–æ–∫—á–µ–π–Ω-—ç–∫—Å–ø–ª–æ—Ä–µ—Ä–∞—Ö.
                    </p>
                    <div id="blockHashes" class="block-hashes"></div>
                </div>

                <div class="seed-info">
                    <h3>Seed (—Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å)</h3>
                    <button id="showSeedGenerationBtn" class="btn btn-small btn-info" style="margin-bottom: 12px;">üîç –ü–æ–∫–∞–∑–∞—Ç—å –∫–∞–∫ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è seed</button>
                    <div id="seedDisplay" class="seed-display"></div>
                    <div id="seedGenerationProcess" class="seed-generation-process hidden">
                        <h4>–ü—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Seed:</h4>
                        <div class="process-steps">
                            <div class="process-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <div class="step-title">–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –±–ª–æ–∫–æ–≤</div>
                                    <div id="concatenatedBlocks" class="step-data"></div>
                                </div>
                            </div>
                            <div class="process-arrow">‚Üì</div>
                            <div class="process-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <div class="step-title">–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –±–∞–π—Ç—ã</div>
                                    <div id="bytesInfo" class="step-data"></div>
                                </div>
                            </div>
                            <div class="process-arrow">‚Üì</div>
                            <div class="process-step">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <div class="step-title">SHA256 —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                                    <div id="sha256Info" class="step-data"></div>
                                </div>
                            </div>
                            <div class="process-arrow">‚Üì</div>
                            <div class="process-step result-step">
                                <div class="step-number">‚úì</div>
                                <div class="step-content">
                                    <div class="step-title">–†–µ–∑—É–ª—å—Ç–∞—Ç: Seed</div>
                                    <div id="finalSeed" class="step-data"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="winner-section">
                    <h3>üèÜ –ü–æ–±–µ–¥–∏—Ç–µ–ª—å</h3>
                    <div id="winnerDisplay" class="winner-display"></div>
                </div>

                <div class="tickets-section">
                    <h3>–í—Å–µ –±–∏–ª–µ—Ç—ã –∏ –∏—Ö score</h3>
                    <button id="showWinnerSelectionBtn" class="btn btn-small btn-info" style="margin-bottom: 12px;">üîç –ü–æ–∫–∞–∑–∞—Ç—å –∫–∞–∫ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—å</button>
                    <div class="tickets-controls">
                        <label>
                            <input type="checkbox" id="showAllScores"> –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ score
                        </label>
                    </div>
                    <div id="ticketsList" class="tickets-list"></div>
                    <div id="winnerSelectionProcess" class="winner-selection-process hidden">
                        <h4>–ü—Ä–æ—Ü–µ—Å—Å –≤—ã–±–æ—Ä–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è:</h4>
                        <div class="selection-steps">
                            <div class="selection-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <div class="step-title">–í—ã—á–∏—Å–ª–µ–Ω–∏–µ Score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∏–ª–µ—Ç–∞</div>
                                    <div id="scoresCalculation" class="step-data"></div>
                                </div>
                            </div>
                            <div class="process-arrow">‚Üì</div>
                            <div class="selection-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <div class="step-title">–ü–æ–∏—Å–∫ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ Score</div>
                                    <div id="minScoreInfo" class="step-data"></div>
                                </div>
                            </div>
                            <div class="process-arrow">‚Üì</div>
                            <div class="selection-step result-step">
                                <div class="step-number">‚úì</div>
                                <div class="step-content">
                                    <div class="step-title">–ü–æ–±–µ–¥–∏—Ç–µ–ª—å</div>
                                    <div id="winnerInfo" class="step-data"></div>
                                </div>
                            </div>
                        </div>
                        <div class="selection-note">
                            <strong>–ü—Ä–∞–≤–∏–ª–æ:</strong> –ü–æ–±–µ–¥–∏—Ç–µ–ª—å ‚Äî –±–∏–ª–µ—Ç —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º Score. 
                            Score –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ SHA256(seed + ":" + –Ω–æ–º–µ—Ä_–±–∏–ª–µ—Ç–∞), –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–π –≤ –±–æ–ª—å—à–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ.
                        </div>
                    </div>
                </div>

                <div class="proof-section">
                    <h3>üîç –î–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</h3>
                    <button id="copyProofBtn" class="btn btn-small">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å JSON</button>
                    <pre id="proofData" class="proof-data"></pre>
                </div>
            </div>
        </div>

        <div id="error" class="error hidden"></div>

        <div class="visual-flow">
            <h2>–í–∏–∑—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞</h2>
            <div class="flow-diagram">
                <div class="flow-step">
                    <div class="flow-icon">‚õìÔ∏è</div>
                    <div class="flow-label">Bitcoin Block</div>
                    <div id="flowBlock" class="flow-value">-</div>
                </div>
                <div class="flow-arrow">‚Üì</div>
                <div class="flow-step">
                    <div class="flow-icon">üé≤</div>
                    <div class="flow-label">Random Seed</div>
                    <div id="flowSeed" class="flow-value">-</div>
                </div>
                <div class="flow-arrow">‚Üì</div>
                <div class="flow-step">
                    <div class="flow-icon">üé´</div>
                    <div class="flow-label">Tickets</div>
                    <div id="flowTickets" class="flow-value">-</div>
                </div>
                <div class="flow-arrow">‚Üì</div>
                <div class="flow-step">
                    <div class="flow-icon">üî¢</div>
                    <div class="flow-label">SHA256(seed:ticket)</div>
                    <div id="flowScores" class="flow-value">-</div>
                </div>
                <div class="flow-arrow">‚Üì</div>
                <div class="flow-step winner-step">
                    <div class="flow-icon">üèÜ</div>
                    <div class="flow-label">Winner (min score)</div>
                    <div id="flowWinner" class="flow-value">-</div>
                </div>
            </div>
        </div>
    </div>

    <script src="static/js/lottery-client.js"></script>
    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –ª–æ–≥–∏–∫–∏
        window.addEventListener('load', () => {
            if (typeof conductLotteryDraw === 'undefined') {
                console.error('–û—à–∏–±–∫–∞: lottery-client.js –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω!');
            } else {
                console.log('‚úÖ –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            }
        });
    </script>
    <script src="static/js/app.js"></script>
</body>
</html>

